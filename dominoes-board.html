<link href='../polymer/polymer.html' rel='import'>
<link href='dominoes-tile.html' rel='import'>
<polymer-element attributes='tiles root' constructor='DominoesBoard' name='dominoes-board'>
  <template>
    <style>:host {
  position: relative;
  width: calc(8*2*$tile-size + 7px);
  height: 370px; }

dominoes-tile {
  position: absolute; }

tile0deg, #tile-5, #tile-4, #tile-3, #tile-2, #tile-1, #tile0, #tile1, #tile2, #tile3, #tile4, #tile5, #tile6, #tile7 {
  top: calc(50% - 21px); }

tile-90deg, #tile8, #tile9, #tile10, #tile11 {
  left: calc(50% + 246px + 22px);
  -webkit-transform: rotate(-90deg);
      -ms-transform: rotate(-90deg);
          transform: rotate(-90deg);
  border-right-width: 1px;
  border-left-width: 4px; }

tile-180deg, #tile12, #tile13, #tile14, #tile15, #tile16, #tile17, #tile18, #tile19, #tile20 {
  top: calc(50% - 21px - 164px);
  -webkit-transform: rotate(-180deg);
      -ms-transform: rotate(-180deg);
          transform: rotate(-180deg);
  border-width: 1px;
  border-top-width: 4px; }

#tile-5 {
  left: calc(50% + -245px); }

#tile-4 {
  left: calc(50% + -204px); }

#tile-3 {
  left: calc(50% + -163px); }

#tile-2 {
  left: calc(50% + -122px); }

#tile-1 {
  left: calc(50% + -81px); }

#tile0 {
  left: calc(50% + -40px); }

#tile1 {
  left: calc(50% + 1px); }

#tile2 {
  left: calc(50% + 42px); }

#tile3 {
  left: calc(50% + 83px); }

#tile4 {
  left: calc(50% + 124px); }

#tile5 {
  left: calc(50% + 165px); }

#tile6 {
  left: calc(50% + 206px); }

#tile7 {
  left: calc(50% + 247px); }

#tile8 {
  top: calc(50% - 41px); }

#tile9 {
  top: calc(50% - 82px); }

#tile10 {
  top: calc(50% - 123px); }

#tile11 {
  top: calc(50% - 164px); }

#tile12 {
  left: calc(50% + 248px); }

#tile13 {
  left: calc(50% + 207px); }

#tile14 {
  left: calc(50% + 166px); }

#tile15 {
  left: calc(50% + 125px); }

#tile16 {
  left: calc(50% + 84px); }

#tile17 {
  left: calc(50% + 43px); }

#tile18 {
  left: calc(50% + 2px); }

#tile19 {
  left: calc(50% + -39px); }

#tile20 {
  left: calc(50% + -80px); }

#tile8 {
  z-index: 2; }

#tile10 {
  z-index: 1; }

#tile12 {
  border-left-width: 4px; }
</style>
    <div class='span'>rootIndex: {{rootIndex}}</div>
    <template repeat='{{tile,i in tiles}}'>
      <dominoes-tile id='tile{{2*(i - rootIndex)}}' left='{{tile[0]}}' right='{{tile[1]}}'></dominoes-tile>
    </template>
  </template>
  <script>(function(scope) {
  'use strict';
  return scope.Polymer('dominoes-board', {
    computed: {
      length: 'tiles.length',
      leftmost: 'tiles.length ? tiles[0][0] : null',
      rightmost: 'tiles.length ? tiles[-1][1] : null',
      rootIndex: 'index(tiles, root)'
    },
    created: function() {
      this.tiles = [];
      return this.root = [];
    },
    move: function(movement) {
      switch (movement.side) {
        case 'left':
          return this.tiles.unshift(movement.tile);
        case 'right':
          return this.tiles.push(movement.tile);
      }
    },
    isPlayable: function(tile) {
      return this.leftmost === tile.left || this.leftmost === tile.right || this.rightmost === tile.left || this.rightmost === tile.right;
    },
    index: function(tiles, tile) {
      var index, match;
      for (index in tiles) {
        match = tiles[index];
        if (match[0] === tile[0] && match[1] === tile[1]) {
          return index;
        }
      }
      return -1;
    },
    fireLasers: function() {
      return this.fire('seed-element-lasers-success', {
        sound: 'Pew pew pew!'
      });
    }
  });
})(window);
</script>
</polymer-element>
